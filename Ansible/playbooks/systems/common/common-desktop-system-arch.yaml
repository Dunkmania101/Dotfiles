---

- name: "Common Desktop System: Arch"
  hosts: all

  collections:
    - name: community.general

  tasks:
    - name: "Add Chaotic-AUR"
      block:
        - name: "Add key"
          command: pacman-key --recv-key FBA220DFC880C036 --keyserver keyserver.ubuntu.com
        - name: "Sign key"
          command: pacman-key --lsign-key FBA220DFC880C036
        - name: "Install Mirrorlist"
          command: pacman -U 'https://cdn-mirror.chaotic.cx/chaotic-aur/chaotic-keyring.pkg.tar.zst' 'https://cdn-mirror.chaotic.cx/chaotic-aur/chaotic-mirrorlist.pkg.tar.zst'
        - name: "Add repo entry"
          ansible.builtin.blockinfile:
            path: /etc/pacman.conf
            block: |

              [chaotic-aur]
              Include = /etc/pacman.d/chaotic-mirrorlist
    - name: "Update System"
      community.general.pacman:
        update_cache: true
        upgrade: true
    - name: "Install Aura & Paru"
      community.general.pacman:
        state: latest
        name: aura paru
    - name: "Install Base Packages"
      community.general.pacman:
        executable: aura
        state: latest
        name: btop xterm acpi vim qtile thunderbird firefox-developer-edition nyxt transmission-gtk transmission-cli lf exa bat fd ripgrep vscodium emacs-pgtk-native-comp-git neovim python-pynvim ctags libvterm cmake gcc cool-retro-term kitty blender steam-native-runtime lutris kicad linux-tkg-bmq linux-tkg-bmq-headers ardour wireshark-qt wireshark-cli speedtest-cli fish pypy3 update-grub element-desktop copyq network-manager-applet cbatticon volumeicon pamac-aur pcmanfm-gtk3 lxappearance-gtk3 lxsession-gtk3 feh sxiv gamemode blueman pipewire pipewire-alsa pipewire-pulse pipewire-jack wireplumber easyeffects alsa-support obs-studio chrony fcron rofi rofimoji rofi-pass rofi-calc neofetch keepassxc pass file-roller tor torsocks onionshare torbrowser-launcher galculator qalculate ttf-iosevka-nerd searx curl wget curlie xss-lock i3lock-color xdotool virt-manager libvirt dnsmasq openbsd-netcat gettext ebtables qemu-desktop qemu-emulators-full lvm2 swtpm openssh glava picard mpd ncmpcpp termdown dbeaver touchegg touche arc-gtk-theme arc-icon-theme
    - name: "Install Base Packages (AUR)"
      community.general.pacman:
        executable: aura
        state: latest
        extra_args: "-A"
        name: gruvbox-material-gtk-theme-git gruvbox-material-icon-theme-git xcursor-simp1e-gruvbox-dark visual-studio-code-bin
    - name: "Update Grub"
      command: update-grub
